{"version":3,"sources":["webpack:///./src/components/SpreadSheet.vue?fbf9***","webpack:///./src/components/SpreadSheet.vue?5d66***","webpack:///./src/components/SpreadSheet.vue?a8d5***","webpack:///SpreadSheet.vue?15f5***","webpack:///./src/script/SpreadSheet.js?f259***","webpack:///./src/components/SpreadSheet.vue?dc98***","webpack:///./src/views/yearreport/Table2.vue","webpack:///./src/views/yearreport/Table2.vue?8f9f","webpack:///./src/views/yearreport/Table2.vue?dccf","webpack:///Table2.vue?d1ed","webpack:///./src/views/yearreport/Table2.vue?3b45"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gGAA+F;AAC/F;AACA,aAAiB,cAAc;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,EAAC,I;;;;;;;ACvBD;;AAEA;AACA;AACA;AACA;AACA,gDAAuF;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,iCAAgC,UAAU,EAAE;AAC5C,E;;;;;;;ACpBA;AACA;;;AAGA;AACA,0DAAyD,qBAAqB,qBAAqB,sCAAsC,WAAW,4BAA4B,oBAAoB,OAAO,4CAA4C,0BAA0B,KAAK,8CAA8C,4BAA4B,KAAK,yDAAyD,oBAAoB,KAAK,iDAAiD,yBAAyB,KAAK,gDAAgD,wBAAwB,KAAK,cAAc,yBAAyB,OAAO,YAAY,gGAAgG,KAAK,KAAK,OAAO,YAAY,KAAK,KAAK,WAAW,KAAK,KAAK,WAAW,MAAM,KAAK,WAAW,OAAO,KAAK,UAAU,KAAK,KAAK,WAAW,KAAK,KAAK,WAAW,MAAM,KAAK,WAAW,0FAA0F,qBAAqB,qBAAqB,sCAAsC,WAAW,4BAA4B,oBAAoB,OAAO,4CAA4C,0BAA0B,KAAK,8CAA8C,4BAA4B,KAAK,yDAAyD,oBAAoB,KAAK,iDAAiD,yBAAyB,KAAK,gDAAgD,wBAAwB,KAAK,cAAc,yBAAyB,OAAO,kQAAkQ,eAAe,gBAAgB,aAAa,OAAO,eAAe,2EAA2E,cAAc,qCAAqC,eAAe,gCAAgC,iBAAiB,6CAA6C,6DAA6D,gHAAgH,OAAO,SAAS,OAAO,kCAAkC,4DAA4D,WAAW,gBAAgB,OAAO,gBAAgB,WAAW,cAAc,2CAA2C,+CAA+C,YAAY,OAAO,KAAK,kDAAkD;;AAEloF;;;;;;;;;;;;;;;AC0CA,uCAEA;;;yBAEA;YAGA;AACA;;;cAKA;;6BAGA;;yBAEA;;cAEA;AAVA;;4DAYA;;kBAEA;2BACA;uBACA;AAHA,UAIA;AAEA;AARA;kCAUA;;4CAEA;AACA;WAEA;YAGA;UAKA;AAzCA,G;;;;;;;ACpDA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,0BAAyB,iBAAiB;;AAE1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC,qBAAqB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,UAAS;;AAET;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAK;AACL;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,kEAAiE;AACjE,YAAW;AACX,8DAA6D;AAC7D,YAAW;AACX;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;;AAGA;;AAEA;AACA;AACA,aAAY,OAAO;AACnB,aAAY,OAAO;AACnB;AACA;;AAEA;AACA;;AAEA;AACA,oBAAmB;AACnB;AACA,mBAAkB;AAClB;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA,mBAAkB,mGAAmG;AACrH;AACA;;AAEA;AACA;AACA;AACA;;AAEA,iBAAgB,qBAAqB;AACrC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB;AACxB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAwB,gBAAgB;AACxC;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,OAAO;AAClB,YAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAY,OAAO;AACnB,aAAY,OAAO;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAY,OAAO;AACnB,aAAY,OAAO;AACnB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAY,OAAO;AACnB,aAAY,OAAO;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAY,OAAO;AACnB,aAAY,OAAO;AACnB,aAAY,OAAO;AACnB,aAAY,OAAO;AACnB;AACA;AACA;;AAEA,uCAAsC,KAAK,KAAK;AAChD;AACA,IAAG;AACH;;;;AAIA;;;;;;;;AC9RA,qM;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gGAA+F;AAC/F;AACA,aAAiB,cAAc;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,EAAC,I;;;;;;;ACvBD;;AAEA;AACA;AACA;AACA;AACA,gDAA0F;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,iCAAgC,UAAU,EAAE;AAC5C,E;;;;;;;ACpBA;AACA;;;AAGA;AACA,qCAAoC,gGAAgG;;AAEpI;;;;;;;;;;;;;;ACiFA;;AADA;;;AAGA;SAEA;AADA;;AAGA;mBAIA;AAHA;;;;AAOA;AAFA;yBAGA;;iBAEA;gBACA;gBACA;aACA;4BAEA;;gBAEA,sHACA,kHACA,mKACA,oHACA,oHAEA,4IACA,6EAEA,qIACA,wEAEA,2IACA,oHACA,qFACA,iFAEA,gHACA,iFAEA,gHACA,6EAGA;AAIA;;AApCA;AAqCA;;;yBAEA;wBACA;AACA;2BACA;oCACA;oCACA;AAEA;;6BAEA;;mBACA;qEAEA;;qBACA;qGACA,0FACA;AACA;oCACA;AAEA;AAEA;;0CAEA;;yCACA;kDACA;kDAEA;;YACA;AAEA;;yCAEA;;+BACA;0BAEA;;8EAEA;AACA;yCACA;gDACA;AACA;uCACA;wDACA;AAEA;AA9CA;2BA+CA;0CAEA;;2EACA;uBAEA;;UACA;AACA;yBACA;iCACA;AACA;AApGA,G;;;;;;;ACnGA,k0BAAi0B,UAAU,GAAG,cAAc,yEAAyE,UAAU,SAAS,iRAAiR,cAAc,gDAAgD,2PAA2P,cAAc,sS","file":"dist/chunks/5-1f7b502685f14205880d.js","sourcesContent":["var __vue_script__, __vue_template__\nrequire(\"!!vue-style-loader!css-loader?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js!./../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./SpreadSheet.vue\")\n__vue_script__ = require(\"!!babel-loader?presets[]=es2015&plugins[]=transform-runtime&comments=false!./../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./SpreadSheet.vue\")\nif (__vue_script__ &&\n    __vue_script__.__esModule &&\n    Object.keys(__vue_script__).length > 1) {\n  console.warn(\"[vue-loader] src\\\\components\\\\SpreadSheet.vue: named exports in *.vue files are ignored.\")}\n__vue_template__ = require(\"!!vue-html-loader!./../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./SpreadSheet.vue\")\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nif (__vue_template__) {\n(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n}\nif (module.hot) {(function () {  module.hot.accept()\n  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), false)\n  if (!hotAPI.compatible) return\n  var id = \"_v-069deb19/SpreadSheet.vue\"\n  if (!module.hot.data) {\n    hotAPI.createRecord(id, module.exports)\n  } else {\n    hotAPI.update(id, module.exports, __vue_template__)\n  }\n})()}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/components/SpreadSheet.vue\n ** module id = 23\n ** module chunks = 2 3 4 5 6 7 8 9 10 11 12 13\n **/","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!./../../node_modules/css-loader/index.js?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js!./../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./SpreadSheet.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!./../../node_modules/vue-style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!./../../node_modules/css-loader/index.js?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js!./../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./SpreadSheet.vue\", function() {\n\t\t\tvar newContent = require(\"!!./../../node_modules/css-loader/index.js?sourceMap!./../../node_modules/vue-loader/lib/style-rewriter.js!./../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./SpreadSheet.vue\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/vue-style-loader!./~/css-loader?sourceMap!./~/vue-loader/lib/style-rewriter.js!./~/vue-loader/lib/selector.js?type=style&index=0!./src/components/SpreadSheet.vue\n ** module id = 24\n ** module chunks = 2 3 4 5 6 7 8 9 10 11 12 13\n **/","exports = module.exports = require(\"./../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \"\\n\\r\\n\\r\\n\\r\\n.sheet-container{\\r\\n  /*width: 900px;\\r\\n  margin: 0 auto;*/\\r\\n\\r\\n  /*margin: 0 120px 0 120px;*/\\r\\n\\r\\n}\\r\\n.sheet-container .sheet{\\r\\n  /*width: 100%;*/\\r\\n}\\r\\n.sheet-container .sheet .sheet-readonly{\\r\\n  background: #F3F3F3;\\r\\n}\\r\\n\\r\\n.sheet-container .sheet .htCore tr td{\\r\\n  vertical-align:middle;\\r\\n}\\r\\n\\r\\n\\r\\n.sheet-container .sheet .htCore tr td.hidden{\\r\\n  display: none;\\r\\n}\\r\\n.sheet-container .sheet .htCore tr td.center{\\r\\n  text-align: center;\\r\\n}\\r\\n.sheet-container .sheet .htCore tr td.right{\\r\\n  text-align: right;\\r\\n}\\r\\n\\r\\n.pane{\\r\\n  /*overflow: hidden;*/\\r\\n}\\r\\n\", \"\", {\"version\":3,\"sources\":[\"/./src/components/SpreadSheet.vue?765ea806\"],\"names\":[],\"mappings\":\";;;;AAIA;EACA;mBACA;;EAEA,4BAAA;;CAEA;AACA;EACA,gBAAA;CACA;AACA;EACA,oBAAA;CACA;;AAEA;EACA,sBAAA;CACA;;;AAGA;EACA,cAAA;CACA;AACA;EACA,mBAAA;CACA;AACA;EACA,kBAAA;CACA;;AAEA;EACA,qBAAA;CACA\",\"file\":\"SpreadSheet.vue\",\"sourcesContent\":[\"\\r\\n<style>\\r\\n\\r\\n\\r\\n.sheet-container{\\r\\n  /*width: 900px;\\r\\n  margin: 0 auto;*/\\r\\n\\r\\n  /*margin: 0 120px 0 120px;*/\\r\\n\\r\\n}\\r\\n.sheet-container .sheet{\\r\\n  /*width: 100%;*/\\r\\n}\\r\\n.sheet-container .sheet .sheet-readonly{\\r\\n  background: #F3F3F3;\\r\\n}\\r\\n\\r\\n.sheet-container .sheet .htCore tr td{\\r\\n  vertical-align:middle;\\r\\n}\\r\\n\\r\\n\\r\\n.sheet-container .sheet .htCore tr td.hidden{\\r\\n  display: none;\\r\\n}\\r\\n.sheet-container .sheet .htCore tr td.center{\\r\\n  text-align: center;\\r\\n}\\r\\n.sheet-container .sheet .htCore tr td.right{\\r\\n  text-align: right;\\r\\n}\\r\\n\\r\\n.pane{\\r\\n  /*overflow: hidden;*/\\r\\n}\\r\\n</style>\\r\\n<template>\\r\\n\\r\\n  <div class=\\\"sheet-container\\\">\\r\\n\\r\\n    <div class=\\\"sheet\\\" id=\\\"handsontable\\\"></div>\\r\\n\\r\\n  </div>\\r\\n\\r\\n</template>\\r\\n\\r\\n<script>\\r\\n\\r\\nconst SpreadSheet = require('script/SpreadSheet')\\r\\n\\r\\nexport default {\\r\\n  data () {\\r\\n    return {\\r\\n\\r\\n    }\\r\\n  },\\r\\n  props: {\\r\\n    // 列配置\\r\\n    columns:[],\\r\\n\\r\\n    // 表格右键菜单\\r\\n    contextMenu:{default: true},\\r\\n\\r\\n    // 是否求和\\r\\n    summary:{default: false},\\r\\n\\r\\n    nosetup:true\\r\\n  },\\r\\n  methods: {\\r\\n    readyHandsontable: function(columns){\\r\\n      this.SpreadSheet = new SpreadSheet('handsontable',{\\r\\n        columns:columns,\\r\\n        contextMenu:this.contextMenu,\\r\\n        summary:this.summary\\r\\n      },this);\\r\\n    }\\r\\n  },\\r\\n  ready: function (columns) {\\r\\n\\r\\n    this.readyHandsontable(this.columns || columns);\\r\\n\\r\\n  },\\r\\n  events: {\\r\\n  },\\r\\n  filters:{\\r\\n\\r\\n  },\\r\\n  watch:{\\r\\n    // 'data': function (val, oldVal) {\\r\\n    //   // this.SpreadSheet.loadData(val);\\r\\n    // }\\r\\n  }\\r\\n}\\r\\n\\r\\n</script>\\r\\n\"],\"sourceRoot\":\"webpack://\"}]);\n\n// exports\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/css-loader?sourceMap!./~/vue-loader/lib/style-rewriter.js!./~/vue-loader/lib/selector.js?type=style&index=0!./src/components/SpreadSheet.vue\n ** module id = 25\n ** module chunks = 2 3 4 5 6 7 8 9 10 11 12 13\n **/","\r\n<style>\r\n\r\n\r\n.sheet-container{\r\n  /*width: 900px;\r\n  margin: 0 auto;*/\r\n\r\n  /*margin: 0 120px 0 120px;*/\r\n\r\n}\r\n.sheet-container .sheet{\r\n  /*width: 100%;*/\r\n}\r\n.sheet-container .sheet .sheet-readonly{\r\n  background: #F3F3F3;\r\n}\r\n\r\n.sheet-container .sheet .htCore tr td{\r\n  vertical-align:middle;\r\n}\r\n\r\n\r\n.sheet-container .sheet .htCore tr td.hidden{\r\n  display: none;\r\n}\r\n.sheet-container .sheet .htCore tr td.center{\r\n  text-align: center;\r\n}\r\n.sheet-container .sheet .htCore tr td.right{\r\n  text-align: right;\r\n}\r\n\r\n.pane{\r\n  /*overflow: hidden;*/\r\n}\r\n</style>\r\n<template>\r\n\r\n  <div class=\"sheet-container\">\r\n\r\n    <div class=\"sheet\" id=\"handsontable\"></div>\r\n\r\n  </div>\r\n\r\n</template>\r\n\r\n<script>\r\n\r\nconst SpreadSheet = require('script/SpreadSheet')\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n\r\n    }\r\n  },\r\n  props: {\r\n    // 列配置\r\n    columns:[],\r\n\r\n    // 表格右键菜单\r\n    contextMenu:{default: true},\r\n\r\n    // 是否求和\r\n    summary:{default: false},\r\n\r\n    nosetup:true\r\n  },\r\n  methods: {\r\n    readyHandsontable: function(columns){\r\n      this.SpreadSheet = new SpreadSheet('handsontable',{\r\n        columns:columns,\r\n        contextMenu:this.contextMenu,\r\n        summary:this.summary\r\n      },this);\r\n    }\r\n  },\r\n  ready: function (columns) {\r\n\r\n    this.readyHandsontable(this.columns || columns);\r\n\r\n  },\r\n  events: {\r\n  },\r\n  filters:{\r\n\r\n  },\r\n  watch:{\r\n    // 'data': function (val, oldVal) {\r\n    //   // this.SpreadSheet.loadData(val);\r\n    // }\r\n  }\r\n}\r\n\r\n</script>\r\n\n\n\n/** WEBPACK FOOTER **\n ** SpreadSheet.vue?765ea806\n **/","/**\r\n * 电子表格\r\n */\r\n\r\nfunction SpreadSheet(id, option, vueCom) {\r\n\r\n  var params = this.parseColumns(option.columns);\r\n\r\n  this.headers = params.headers;\r\n\r\n  this.vueCom = vueCom;\r\n\r\n  var sheet = null,\r\n      thisz = this,\r\n      columns = params.columns,\r\n      henderSize = params.headers.length;\r\n\r\n  // if(option.summary) { henderSize += 1; }\r\n\r\n  var container = document.getElementById(id);\r\n  this.sheet = sheet = new Handsontable(container, {\r\n    data: params.headers,\r\n    //autoColumnSize:true,\r\n    //rowHeaders: true,\r\n    //colHeaders: true,\r\n    autoWrapRow:true,\r\n    autoWrapCol:true,\r\n    rowHeights: 30,\r\n    stretchH:'all',\r\n    // fixedRowsTop: 2,\r\n    // colWidths:['*',0.1],\r\n    columns: columns,\r\n    readOnlyCellClassName:'sheet-readonly',\r\n    //contextMenu: ['row_above', 'row_below', 'remove_row', '---------', 'undo', 'redo'],\r\n    afterBeginEditing: function(row, column){\r\n      vueCom.$dispatch('sheet.afterBeginEditing', row, column);\r\n    },\r\n    afterChange: function(changes, source){\r\n      if(changes) {\r\n\r\n        changes.forEach(function(change, idx){\r\n\r\n          var row = change[0];\r\n          var field = change[1];\r\n          var val = change[3];\r\n          var col = params.colIndex[field];\r\n\r\n          // 公式计算\r\n          var compute = params.compute;\r\n          if(compute && !compute[field]){\r\n            var reocrd = this.getSourceDataAtRow(row);\r\n            for (var key in compute) {\r\n              var c = compute[key];\r\n              this.setDataAtCell(row, c.tagCol, eval(thisz.parseExpr(c.compute,reocrd)) || '');\r\n            }\r\n          }\r\n          // 求和\r\n          if(option.summary){\r\n            var sumRow = henderSize + 1,colSum = 0,colArray  = this.getDataAtCol(col);\r\n            if(henderSize != row){\r\n              for (var i = sumRow; i < colArray.length; i++) {\r\n                var num = colArray[i];\r\n                if(num && !isNaN(num)){\r\n                  colSum += num;\r\n                }\r\n              }\r\n              this.setDataAtCell(henderSize, col, colSum);\r\n            }\r\n          }\r\n\r\n          vueCom.$dispatch('sheet.afterChange', row, col, field, val, source);\r\n\r\n        },this);\r\n\r\n      }\r\n    },\r\n    cells: function (row, col, prop) {\r\n\r\n      var colprop = columns[col];\r\n      // 表头只读\r\n      if(row < henderSize){\r\n        this.readOnly = true;\r\n        this.renderer = 'html';\r\n        if(thisz.sheet){\r\n          thisz.setCellClass(row, col,'center');\r\n        }\r\n      }\r\n\r\n    },\r\n    mergeCells: params.merge\r\n  });\r\n\r\n  if(option.contextMenu == true){\r\n    sheet.updateSettings({\r\n      contextMenu: {\r\n        /*\r\n        callback: function (key, options) {\r\n          if (key === 'before_ins') {\r\n            vueCom.data.splice(sheet.getSelected()[0] - 1, 0, [{}]);\r\n          } else if (key === 'after_ins') {\r\n            vueCom.data.splice(sheet.getSelected()[2], 0, [{}]);\r\n          } else if (key === 'aremove_row') {\r\n            vueCom.data.splice(sheet.getSelected()[0] - 1, 1);\r\n          }\r\n        },*/\r\n        items: {\r\n          'row_above': {\r\n            name:'前插入行',\r\n            disabled: function () {\r\n              return (sheet.getSelected() && sheet.getSelected()[0] === 0);\r\n            }\r\n          },\r\n          'row_below': {\r\n            name:'后插入行',\r\n            disabled: function () {\r\n              return (sheet.getSelected() && sheet.getSelected()[0] === 0);\r\n            }\r\n          },\r\n          'hsep1': '---------',\r\n          'remove_row': {\r\n            name:'删除行',\r\n            disabled: function () {\r\n              return  (sheet.getSelected() && sheet.getSelected()[0] === 0);\r\n            }\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n};\r\n\r\n/**\r\n * 解析列参数\r\n * @param  {[type]} __columns [description]\r\n * @return {[type]}           [description]\r\n */\r\nSpreadSheet.prototype.parseColumns = function(__columns){\r\n\r\n  var thisz = this;\r\n  var _columns = JSON.parse(JSON.stringify(__columns));\r\n\r\n  var columns = [],\r\n      headers = [{}],\r\n      merge = [],\r\n      compute = {},\r\n      colIndex = {};\r\n\r\n  function getAttribute(shw, row, col){\r\n      if(typeof(shw) == 'string'){\r\n          shw = {text:shw};\r\n      };\r\n      merge.push({row: row, col: col, rowspan: shw.rowspan ? shw.rowspan : 1, colspan: shw.colspan ? shw.colspan : 1});\r\n      return shw;\r\n  }\r\n\r\n  function _addClass(column, className){\r\n    if(!column.className)  column.className = ''\r\n    column.className += ' ' + className\r\n  }\r\n\r\n  for(var i = 0; i < _columns.length; i++){\r\n      var _column = _columns[i],\r\n          tag = _column.tag;\r\n\r\n      colIndex[tag] = i;\r\n      var column = {}\r\n      if(tag) column.data = tag\r\n      if(_column.type) column.type = _column.type\r\n      if(_column.format) column.format = _column.format\r\n      if(_column.hidden) _addClass(column, 'hidden')\r\n      if(_column.align) _addClass(column, _column.align)\r\n      if(_column.readOnly) column.readOnly = _column.readOnly\r\n      if(_column.renderer) {\r\n        var rendererName = _column.renderer;\r\n        column.renderer = function(instance, td, row, col, prop, value, cellProperties){\r\n          thisz.vueCom.$dispatch(rendererName, instance, td, row, col, prop, value, cellProperties);\r\n          Handsontable.renderers.TextRenderer.apply(this, arguments);\r\n        };\r\n      }\r\n      if(_column.compute) {\r\n        compute[tag] = {compute:_column.compute,tagCol:i};\r\n      }\r\n\r\n      if(_column.editor) {\r\n        if(_column.editor.type == 'select'){\r\n          column.type = 'dropdown';\r\n          column.allowInvalid = true;\r\n          column.source = _column.editor.data;\r\n        }\r\n        if(_column.editor.type == 'date'){\r\n          column.type = 'date';\r\n          column.correctFormat = true;\r\n          column.dateFormat = 'YYYY-MM-DD';\r\n        }\r\n      }\r\n\r\n      var shw = _column.shw;\r\n      if(shw.constructor == Object || shw.constructor == String){\r\n          headers[0][tag] = getAttribute(shw,0,i).text;\r\n      }\r\n      if(shw.constructor == Array){\r\n          for(var r = 0; r < shw.length; r++){\r\n              var _shw = shw[r];\r\n\r\n              if(!headers[r]) headers[r] = {};\r\n              if(_shw) headers[r][tag] = getAttribute(_shw, r, i).text;\r\n          }\r\n      }\r\n\r\n      columns.push(column)\r\n  }\r\n\r\n  return {\r\n    columns: columns,\r\n    headers: headers,\r\n    merge: merge,\r\n    compute: compute,\r\n    colIndex: colIndex\r\n  };\r\n\r\n};\r\n/**\r\n * 设置单元格 className\r\n * @param {[type]} row       [description]\r\n * @param {[type]} col       [description]\r\n * @param {[type]} className [description]\r\n */\r\nSpreadSheet.prototype.setCellClass = function(row, col, className){\r\n  var cell = this.sheet.getCell(row, col);\r\n  if(cell){\r\n    cell.classList.add(className);\r\n  }\r\n};\r\n\r\n/**\r\n * 加载本地数据\r\n * @param  {[type]} data [description]\r\n * @return {[type]}      [description]\r\n */\r\nSpreadSheet.prototype.loadData = function(data){\r\n  this.sheet.loadData( this.headers.concat(data) );\r\n};\r\n\r\n/**\r\n * 获取数据\r\n * @param  {[type]} data [description]\r\n * @return {[type]}      [description]\r\n */\r\nSpreadSheet.prototype.getData = function(){\r\n\r\n  var data = this.sheet.getSourceData();\r\n  if(!this.isInitData){\r\n    data.splice(0, this.headers.length);\r\n    this.isInitData = true;\r\n  }\r\n  return data;\r\n};\r\n\r\n/**\r\n * 添加行\r\n * @param  {[type]} data [description]\r\n * @return {[type]}      [description]\r\n */\r\nSpreadSheet.prototype.addRow = function(data){\r\n  this.sheet.alter('insert_row', this.sheet.getData().length);\r\n};\r\n\r\n/**\r\n * 解析表达式\r\n * @param  {[type]} tStr    表达式\r\n * @param  {[type]} dataObj json数据\r\n * @param  {[type]} regexp  [description]\r\n * @return {[type]}         [description]\r\n */\r\nSpreadSheet.prototype.parseExpr = function(tStr,dataObj,regexp){\r\n  tStr = typeof(tStr) == \"object\" ? tStr.join('') : tStr;\r\n\r\n  return tStr.replace(regexp || /\\\\?\\{([^{}]+)\\}/g, function (match, name) {\r\n      return (dataObj[name] === undefined) ? ((typeof (dataObj ) == \"string\") ? dataObj : 0 ): dataObj[name] || 0;\r\n  });\r\n};\r\n\r\n\r\n\r\nmodule.exports = SpreadSheet;\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/script/SpreadSheet.js\n ** module id = 27\n ** module chunks = 2 3 4 5 6 7 8 9 10 11 12 13\n **/","module.exports = \"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n<div class=\\\"sheet-container\\\">\\n\\n  <div class=\\\"sheet\\\" id=\\\"handsontable\\\"></div>\\n\\n</div>\\n\\n\";\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/vue-html-loader!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/SpreadSheet.vue\n ** module id = 28\n ** module chunks = 2 3 4 5 6 7 8 9 10 11 12 13\n **/","var __vue_script__, __vue_template__\nrequire(\"!!vue-style-loader!css-loader?sourceMap!./../../../node_modules/vue-loader/lib/style-rewriter.js!./../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./Table2.vue\")\n__vue_script__ = require(\"!!babel-loader?presets[]=es2015&plugins[]=transform-runtime&comments=false!./../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./Table2.vue\")\nif (__vue_script__ &&\n    __vue_script__.__esModule &&\n    Object.keys(__vue_script__).length > 1) {\n  console.warn(\"[vue-loader] src\\\\views\\\\yearreport\\\\Table2.vue: named exports in *.vue files are ignored.\")}\n__vue_template__ = require(\"!!vue-html-loader!./../../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./Table2.vue\")\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nif (__vue_template__) {\n(typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports).template = __vue_template__\n}\nif (module.hot) {(function () {  module.hot.accept()\n  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), false)\n  if (!hotAPI.compatible) return\n  var id = \"_v-7c82d89e/Table2.vue\"\n  if (!module.hot.data) {\n    hotAPI.createRecord(id, module.exports)\n  } else {\n    hotAPI.update(id, module.exports, __vue_template__)\n  }\n})()}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/views/yearreport/Table2.vue\n ** module id = 65\n ** module chunks = 5\n **/","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!./../../../node_modules/css-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/style-rewriter.js!./../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./Table2.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!./../../../node_modules/vue-style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!./../../../node_modules/css-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/style-rewriter.js!./../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./Table2.vue\", function() {\n\t\t\tvar newContent = require(\"!!./../../../node_modules/css-loader/index.js?sourceMap!./../../../node_modules/vue-loader/lib/style-rewriter.js!./../../../node_modules/vue-loader/lib/selector.js?type=style&index=0!./Table2.vue\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/vue-style-loader!./~/css-loader?sourceMap!./~/vue-loader/lib/style-rewriter.js!./~/vue-loader/lib/selector.js?type=style&index=0!./src/views/yearreport/Table2.vue\n ** module id = 66\n ** module chunks = 5\n **/","exports = module.exports = require(\"./../../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \"\\n\", \"\", {\"version\":3,\"sources\":[],\"names\":[],\"mappings\":\"\",\"file\":\"Table2.vue\",\"sourceRoot\":\"webpack://\"}]);\n\n// exports\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/css-loader?sourceMap!./~/vue-loader/lib/style-rewriter.js!./~/vue-loader/lib/selector.js?type=style&index=0!./src/views/yearreport/Table2.vue\n ** module id = 67\n ** module chunks = 5\n **/","<style>\r\n</style>\r\n<template>\r\n\r\n  <div class=\"container-row\">\r\n\r\n    <div class=\"tbar toolbar-actions\">\r\n      <button class=\"btn btn-default\" v-on:click=\"add\" v-show=\"addshow\">\r\n        <span class=\"icon icon-plus icon-text\"></span>\r\n        添加\r\n      </button>\r\n      <button class=\"btn btn-primary\" v-on:click=\"save\">\r\n        <span class=\"icon icon-home icon-text white\"></span>\r\n        保存\r\n      </button>\r\n\r\n      <div class=\"pull-right\">\r\n        <button class=\"btn btn-positive\" v-on:click=\"exportExcel\">\r\n          <span class=\"icon icon-export icon-text white\"></span>\r\n          导出\r\n        </button>\r\n\r\n        <button class=\"btn btn-positive\" v-on:click=\"importExcel\">\r\n          <span class=\"icon icon-download icon-text white\"></span>\r\n          导入\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"head\">\r\n        <h2>{{DATAYEAR}} {{$route.cname}}</h2>\r\n        <div class=\"info\">\r\n          <span style=\"font-size: 14px;\">填报单位：{{DATACOM}}</span>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"pane\">\r\n      <spread-sheet :columns=\"columns\" nosetup=true></spread-sheet>\r\n    </div>\r\n\r\n    <div class=\"table-tabs\">\r\n\r\n      <div class=\"tab-group\">\r\n          <div class=\"tab-item\" name='DEF' v-on:click=\"changeTab\">{{$route.cname}}</div>\r\n      </div>\r\n\r\n      <a href=\"javascript:;\" class=\"xbut\" @click=\"toggleInfo\">\r\n        <span class=\"icon icon-info-circled icon-text\"></span>\r\n        填表说明\r\n      </a>\r\n\r\n    </div>\r\n\r\n\r\n\r\n\r\n  <div class=\"g-modal\">\r\n    <div class=\"container-row\">\r\n\r\n\r\n      <div class=\"content\">\r\n        <h3>{{$route.cname}}</h3>\r\n\r\n        <p>\r\n            <span>填报说明：</span>\r\n        </p>\r\n\r\n      </div>\r\n\r\n      <footer class=\"footer\">\r\n        <div class=\"actions\">\r\n          <button class=\"btn\"  @click=\"toggleInfo\">\r\n            关 闭\r\n          </button>\r\n        </div>\r\n      </footer>\r\n\r\n    </div>\r\n  </div>\r\n\r\n\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nconst SpreadSheet = require('components/SpreadSheet.vue')\r\nimport { PD } from 'Db/datas'\r\n\r\nconst params = {\r\n  type:'DEF'\r\n}\r\n\r\nconst pageparams = {\r\n  SX_DATA: [\"自营\",\"合作\"]\r\n}\r\n\r\nexport default {\r\n  components: {\r\n    SpreadSheet\r\n  },\r\n  data () {\r\n    return {\r\n      DATAYEAR : DATAYEAR,\r\n      DATACOM : DATACOM,\r\n      addshow:true,\r\n      data: [],\r\n      columns : function(){\r\n\r\n        return [\r\n            //{tag:\"F_ID\",shw:{text:\"ID\",rowspan:3},siz:100,hidden:true},\r\n            {tag:\"F_SX\",shw:{text:\"属性\",rowspan:2},siz:20,align:'center',editor:{type:'select',data:pageparams.SX_DATA}},\r\n            {tag:\"F_JH\",shw:{text:\"井号<strong style='color: red'>*</strong>\",rowspan:2},siz:20,align:'center'},\r\n            {tag:\"F_PD\",shw:{text:\"地区(盆地)<strong style='color: red'>*</strong>\",rowspan:2},siz:100,editor:{type:'select',data:PD},align:'center'},\r\n            {tag:\"F_QK\",shw:{text:\"区块名称<strong style='color: red'>*</strong>\",rowspan:2},siz:100,align:'center'},\r\n            {tag:\"F_QB\",shw:{text:\"圈闭名称<strong style='color: red'>*</strong>\",rowspan:2},siz:100,align:'center'},\r\n\r\n            {tag:\"F_JD\",shw:[{text:\"坐标<strong style='color: red'>*</strong>\",colspan:2},\"经度\"],siz:100,type:'numeric',format:'0.00'},\r\n            {tag:\"F_WD\",shw:[\"\",\"纬度\"],siz:100,type:'numeric',format:'0.00'},\r\n\r\n            {tag:\"F_KZRQ\",shw:[{text:\"钻井日期<strong style='color: red'>*</strong>\",colspan:2},\"开钻\"],siz:100,editor:{type:'date'}},\r\n            {tag:\"F_WZRQ\",shw:[\"\",\"完钻\"],siz:100,editor:{type:'date'}},\r\n\r\n            {tag:\"F_WZJS\",shw:{text:\"完钻井深(米)<strong style='color: red'>*</strong>\",rowspan:2},siz:100,type:'numeric',format:'0.00'},\r\n            {tag:\"F_WZCW\",shw:{text:\"完钻层位<strong style='color: red'>*</strong>\",rowspan:2},siz:100,align:'center'},\r\n            {tag:\"F_CJJSCG\",shw:{text:\"测井解释成果\",rowspan:2},siz:100,align:'center'},\r\n            {tag:\"F_CSJK\",shw:{text:\"测试简况\",rowspan:2},siz:100,align:'center'},\r\n\r\n            {tag:\"F_YRC\",shw:[{text:\"试油日产油气情况\",colspan:2},\"油(吨)\"],siz:100,type:'numeric',format:'0.00'},\r\n            {tag:\"F_QRC\",shw:[\"\",\"气(万方)\"],siz:100,type:'numeric',format:'0.00'},\r\n\r\n            {tag:\"F_JL\",shw:{text:\"结论<strong style='color: red'>*</strong>\",rowspan:2},siz:100,align:'center'},\r\n            {tag:\"F_BZ\",shw:{text:\"备注\",rowspan:2},siz:100,align:'center'}\r\n\r\n        ];\r\n      }()\r\n\r\n\r\n    }\r\n  },\r\n  methods: {\r\n    add: function(){\r\n      this.SpreadSheet.addRow();\r\n    },\r\n    save: function(){\r\n      this.data = this.SpreadSheet.getData()\r\n      commonVue.methods.save(this, params)\r\n    },\r\n\r\n    query: function () {\r\n\r\n      let thisz = this\r\n      commonVue.methods.query(this, params, function(rows, isinit){\r\n\r\n        if(isinit) {\r\n          rows = [{\"F_SX\":\"自营\"},{\"F_SX\":\"自营\"},{\"F_SX\":\"自营\"},{\"F_SX\":\"自营\"},{\"F_SX\":\"自营\"},\r\n                {\"F_SX\":\"合作\"},{\"F_SX\":\"合作\"},{\"F_SX\":\"合作\"},{\"F_SX\":\"合作\"},{\"F_SX\":\"合作\"}]\r\n        }\r\n        thisz.SpreadSheet.loadData(rows)\r\n      })\r\n\r\n    },\r\n\r\n    changeTab: function(event){\r\n\r\n      if(event.toElement.classList[1]) return\r\n      common.toggleClassByLevel(event.toElement, \"active\")\r\n      params.type = event.toElement.getAttribute(\"name\")\r\n\r\n      this.query()\r\n    },\r\n\r\n    exportExcel: function(){\r\n\r\n      let title = this.$route.name\r\n      let columns = this.columns\r\n\r\n      commonVue.methods.exportExcel(this, this.SpreadSheet.getData(), title, columns)\r\n\r\n    },\r\n    importExcel: function(){\r\n      commonVue.methods.importExcel(this,this.columns)\r\n    },\r\n    toggleInfo: function () {\r\n      common.queryElement('.g-modal').classList.toggle('visible')\r\n    }\r\n  },\r\n  ready: function () {\r\n    this.SpreadSheet = this.$children[0].SpreadSheet;\r\n\r\n    let tab = common.queryElement(\".tab-group div[name='\" + params.type + \"']\")\r\n    tab.classList.add('active')\r\n\r\n    this.query()\r\n  },\r\n  init: function () {\r\n    params.tbname = this.$route.name\r\n  }\r\n}\r\n</script>\r\n\n\n\n/** WEBPACK FOOTER **\n ** Table2.vue?55a5403c\n **/","module.exports = \"\\n\\n\\n\\n<div class=\\\"container-row\\\">\\n\\n  <div class=\\\"tbar toolbar-actions\\\">\\n    <button class=\\\"btn btn-default\\\" v-on:click=\\\"add\\\" v-show=\\\"addshow\\\">\\n      <span class=\\\"icon icon-plus icon-text\\\"></span>\\n      添加\\n    </button>\\n    <button class=\\\"btn btn-primary\\\" v-on:click=\\\"save\\\">\\n      <span class=\\\"icon icon-home icon-text white\\\"></span>\\n      保存\\n    </button>\\n\\n    <div class=\\\"pull-right\\\">\\n      <button class=\\\"btn btn-positive\\\" v-on:click=\\\"exportExcel\\\">\\n        <span class=\\\"icon icon-export icon-text white\\\"></span>\\n        导出\\n      </button>\\n\\n      <button class=\\\"btn btn-positive\\\" v-on:click=\\\"importExcel\\\">\\n        <span class=\\\"icon icon-download icon-text white\\\"></span>\\n        导入\\n      </button>\\n    </div>\\n  </div>\\n\\n  <div class=\\\"head\\\">\\n      <h2>{{DATAYEAR}} {{$route.cname}}</h2>\\n      <div class=\\\"info\\\">\\n        <span style=\\\"font-size: 14px;\\\">填报单位：{{DATACOM}}</span>\\n      </div>\\n  </div>\\n\\n  <div class=\\\"pane\\\">\\n    <spread-sheet :columns=\\\"columns\\\" nosetup=true></spread-sheet>\\n  </div>\\n\\n  <div class=\\\"table-tabs\\\">\\n\\n    <div class=\\\"tab-group\\\">\\n        <div class=\\\"tab-item\\\" name='DEF' v-on:click=\\\"changeTab\\\">{{$route.cname}}</div>\\n    </div>\\n\\n    <a href=\\\"javascript:;\\\" class=\\\"xbut\\\" @click=\\\"toggleInfo\\\">\\n      <span class=\\\"icon icon-info-circled icon-text\\\"></span>\\n      填表说明\\n    </a>\\n\\n  </div>\\n\\n\\n\\n\\n<div class=\\\"g-modal\\\">\\n  <div class=\\\"container-row\\\">\\n\\n\\n    <div class=\\\"content\\\">\\n      <h3>{{$route.cname}}</h3>\\n\\n      <p>\\n          <span>填报说明：</span>\\n      </p>\\n\\n    </div>\\n\\n    <footer class=\\\"footer\\\">\\n      <div class=\\\"actions\\\">\\n        <button class=\\\"btn\\\"  @click=\\\"toggleInfo\\\">\\n          关 闭\\n        </button>\\n      </div>\\n    </footer>\\n\\n  </div>\\n</div>\\n\\n\\n\\n</div>\\n\";\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/vue-html-loader!./~/vue-loader/lib/selector.js?type=template&index=0!./src/views/yearreport/Table2.vue\n ** module id = 69\n ** module chunks = 5\n **/"],"sourceRoot":""}